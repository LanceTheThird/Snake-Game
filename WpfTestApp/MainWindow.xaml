<Window x:Class="WpfTestApp.MainWindow" Name="Window"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:WpfTestApp.ViewModels"
        xmlns:wpfTestApp="clr-namespace:WpfTestApp"
        d:DataContext="{d:DesignInstance wpfTestApp:ViewModel}"
        mc:Ignorable="d"
        Title="Snake" MinHeight="400" MinWidth="800" Width="{Binding Path=WindowWidth, Mode=TwoWay}"
        Height="{Binding Path=WindowHeight, Mode=TwoWay}">
    <Window.Resources>

        <ItemsPanelTemplate x:Key="ListPanelTemplate">
            <Canvas x:Name="Canvas" />
        </ItemsPanelTemplate>

        <DataTemplate x:Key="ListTemplate" DataType="vm:Block">

            <DataTemplate.Resources>
                <Style TargetType="TextBlock">
                    <Setter Property="Height" Value="40" />
                    <Setter Property="Width" Value="40" />

                </Style>
                <Style TargetType="Border">
                    <Setter Property="BorderBrush" Value="Black" />
                    <Setter Property="BorderThickness" Value="1" />
                </Style>
            </DataTemplate.Resources>

            <!--grid-->
            <Path x:Name="Icon" Stroke="#FF000000" StrokeThickness="1px" StrokeLineJoin="Miter">
                <Path.RenderTransform>
                    <ScaleTransform CenterX="0" CenterY="0" ScaleX="{Binding Scale}" ScaleY="{Binding Scale}" />
                </Path.RenderTransform>
                <Path.LayoutTransform>
                    <RotateTransform CenterX="0" CenterY="0" Angle="{Binding View}" />
                </Path.LayoutTransform>
            </Path>

            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding ChainType}" Value="Food">
                    <Setter Property="Fill" TargetName="Icon" Value="#D45500" />
                    <Setter Property="Data" TargetName="Icon"
                            Value="F 1 M 32,62 C 45.233,62 56,51.233 56,38 56,25.102 45.771,14.552 33,14.025 L 33,9 35.598,9 C 36.813,10.127 41.395,14 47,14 53.42,14 58.499,8.918 58.713,8.702 59.096,8.313 59.096,7.688 58.713,7.299 58.499,7.082 53.42,2 47,2 41.395,2 36.813,5.873 35.598,7 L 33,7 33,2 31,2 31,14.025 C 18.229,14.552 8,25.102 8,38 8,51.233 18.767,62 32,62 Z M 47,4 C 51.233,4 54.947,6.688 56.507,8 54.947,9.312 51.234,12 47,12 43.679,12 40.682,10.346 38.79,9 L 50,9 50,7 38.79,7 C 40.682,5.654 43.679,4 47,4 Z M 32,16 C 44.131,16 54,25.869 54,38 54,50.131 44.131,60 32,60 19.869,60 10,50.131 10,38 10,25.869 19.869,16 32,16 Z" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ChainType}" Value="Head">
                    <Setter Property="Fill" TargetName="Icon" Value='DarkGreen' />
                    <Setter Property="Data" TargetName="Icon"
                            Value="F 1 M 61,2 C 57.665,2 54.483,2.714 51.572,4 L 37.716,4 C 36.888,2.634 34.372,2 32,2 29.628,2 27.112,2.634 26.284,4 L 12.428,4 C 9.517,2.714 6.335,2 3,2 2.448,2 2,2.448 2,3 L 2,11.586 C 2,12.663 2.399,13.67 3.101,14.473 3.033,15.247 2.985,16.177 3,17.208 L 3,34.843 C 2.364,35.646 2,36.643 2,37.704 2,39.23 2.768,40.648 4,41.501 L 4,49 C 4,56.168 9.832,62 17,62 L 47,62 C 54.168,62 60,56.168 60,49 L 60,41.5 C 61.232,40.647 62,39.228 62,37.703 62,36.642 61.636,35.645 61,34.842 L 61,17.208 C 61.015,16.177 60.967,15.248 60.899,14.474 61.601,13.67 62,12.663 62,11.586 L 62,3 C 62,2.448 61.552,2 61,2 Z M 60,11.586 C 60,11.589 59.999,11.591 59.999,11.594 59.943,11.572 59.89,11.545 59.829,11.533 59.536,11.476 54.503,10.534 49.832,11.846 49.724,11.876 49.615,11.905 49.51,11.937 49.296,12.002 49.086,12.073 48.874,12.149 48.696,12.212 48.523,12.279 48.352,12.348 48.187,12.415 48.023,12.479 47.861,12.553 47.654,12.647 47.457,12.749 47.26,12.852 47.199,12.884 47.136,12.913 47.077,12.946 47.021,12.977 46.961,13.005 46.905,13.036 46.834,13.077 46.767,13.124 46.697,13.166 46.591,13.229 46.487,13.294 46.385,13.361 46.338,13.391 46.289,13.419 46.242,13.45 46.132,13.524 46.028,13.602 45.922,13.679 45.834,13.743 45.748,13.808 45.662,13.875 45.642,13.891 45.62,13.906 45.6,13.922 45.559,13.954 45.514,13.984 45.474,14.017 45.234,14.214 45.004,14.419 44.788,14.636 44.519,14.905 44.265,15.198 44.02,15.519 43.976,15.575 43.929,15.63 43.887,15.687 43.852,15.734 43.823,15.788 43.788,15.836 43.54,16.181 43.314,16.539 43.111,16.908 43.086,16.953 43.065,17.002 43.041,17.047 42.821,17.46 42.628,17.883 42.458,18.316 42.449,18.338 42.441,18.361 42.432,18.383 41.087,21.858 41.217,25.808 41.449,28 L 38.019,28 C 38.49,15.038 48.085,4.58 60,4.023 L 60,11.586 Z M 51.559,13.492 C 52.48,14.425 53,15.68 53,17 53,19.757 50.757,22 48,22 46.406,22 44.938,21.254 43.995,19.983 44.101,19.63 44.224,19.299 44.352,18.976 45.07,19.616 46.005,20 47,20 49.206,20 51,18.206 51,16 51,15.203 50.751,14.444 50.32,13.8 50.703,13.691 51.089,13.584 51.506,13.502 51.524,13.499 51.541,13.495 51.559,13.492 Z M 45.641,16.699 C 45.817,16.476 45.996,16.258 46.191,16.063 46.195,16.059 46.198,16.055 46.202,16.051 46.22,16.033 46.244,16.019 46.262,16.001 46.531,15.738 46.827,15.496 47.143,15.268 47.197,15.229 47.252,15.193 47.307,15.155 47.461,15.05 47.634,14.96 47.799,14.863 47.981,14.755 48.156,14.642 48.351,14.544 48.759,14.918 49,15.443 49,16 49,17.103 48.103,18 47,18 46.33,18 45.711,17.654 45.346,17.106 45.364,17.08 45.38,17.051 45.398,17.026 45.478,16.911 45.56,16.805 45.641,16.699 Z M 43.488,22.332 C 44.732,23.392 46.311,24 48,24 51.86,24 55,20.86 55,17 55,15.634 54.595,14.322 53.867,13.201 55.95,13.069 57.807,13.258 58.763,13.39 59.064,15.562 59.669,22.382 56.1,25.951 52.54,29.512 45.712,28.911 43.538,28.612 43.378,27.447 43.135,24.949 43.488,22.332 Z M 30,7.844 C 30.651,7.947 31.331,8 32,8 32.669,8 33.349,7.947 34,7.844 L 34,10 30,10 30,7.844 Z M 32,4 C 34.347,4 35.717,4.673 35.975,5 35.717,5.327 34.347,6 32,6 29.653,6 28.283,5.327 28.025,5 28.283,4.673 29.653,4 32,4 Z M 4,4.023 C 15.915,4.58 25.51,15.038 25.982,28 L 22.552,28 C 22.784,25.808 22.914,21.858 21.568,18.383 21.559,18.361 21.551,18.339 21.543,18.317 21.372,17.883 21.179,17.459 20.958,17.045 20.934,17 20.913,16.953 20.889,16.908 20.685,16.538 20.459,16.18 20.21,15.833 20.176,15.786 20.147,15.733 20.113,15.686 20.071,15.629 20.024,15.575 19.98,15.518 19.735,15.198 19.481,14.904 19.212,14.635 19.195,14.618 19.175,14.603 19.158,14.587 18.957,14.389 18.748,14.199 18.527,14.018 18.479,13.979 18.426,13.944 18.378,13.905 18.364,13.894 18.35,13.884 18.336,13.873 18.251,13.807 18.165,13.742 18.078,13.679 17.973,13.602 17.869,13.524 17.76,13.451 17.708,13.416 17.653,13.385 17.6,13.351 17.499,13.286 17.397,13.221 17.292,13.159 17.226,13.12 17.163,13.075 17.097,13.037 17.041,13.005 16.982,12.977 16.925,12.946 16.861,12.911 16.794,12.879 16.728,12.845 16.532,12.743 16.335,12.641 16.129,12.548 15.977,12.479 15.823,12.419 15.668,12.356 15.484,12.281 15.297,12.209 15.105,12.141 14.907,12.071 14.709,12.004 14.509,11.943 14.382,11.904 14.251,11.869 14.121,11.833 9.462,10.54 4.46,11.475 4.168,11.531 4.108,11.543 4.054,11.57 3.998,11.592 4.001,11.591 4,11.589 4,11.586 L 4,4.023 Z M 20.459,28.612 C 18.287,28.912 11.467,29.518 7.898,25.949 4.337,22.389 4.938,15.56 5.237,13.387 6.193,13.255 8.05,13.064 10.135,13.195 9.406,14.318 9,15.632 9,17 9,20.86 12.14,24 16,24 17.687,24 19.265,23.393 20.508,22.335 20.86,24.951 20.619,27.449 20.459,28.612 Z M 18.357,16.697 C 18.44,16.804 18.522,16.912 18.603,17.027 18.621,17.052 18.636,17.08 18.654,17.105 18.289,17.654 17.67,18 17,18 15.897,18 15,17.103 15,16 15,15.443 15.241,14.918 15.649,14.543 15.845,14.641 16.02,14.755 16.202,14.862 16.37,14.961 16.546,15.053 16.702,15.159 16.752,15.193 16.802,15.226 16.851,15.261 17.191,15.505 17.512,15.763 17.798,16.049 17.997,16.248 18.178,16.471 18.357,16.697 Z M 17,20 C 17.995,20 18.93,19.616 19.648,18.976 19.777,19.299 19.9,19.631 20.005,19.984 19.062,21.254 17.594,22 16,22 13.243,22 11,19.757 11,17 11,15.679 11.521,14.423 12.443,13.489 12.879,13.573 13.28,13.686 13.68,13.8 13.249,14.444 13,15.203 13,16 13,18.206 14.794,20 17,20 Z M 47,60 L 17,60 C 10.935,60 6,55.065 6,49 L 6,42.517 9,43.929 9,48 C 9,52.962 13.038,57 18,57 L 46,57 C 50.962,57 55,52.962 55,48 L 55,43.929 58,42.517 58,49 C 58,55.065 53.065,60 47,60 Z M 48.323,54.595 L 45.857,50.485 C 45.496,49.882 44.503,49.882 44.142,50.485 L 41.434,55 22.566,55 19.857,50.485 C 19.496,49.882 18.503,49.882 18.142,50.485 L 15.676,54.595 C 12.957,53.634 11,51.045 11,48 L 11,44.87 17.985,48.157 C 19.274,48.763 20.743,48.745 22.018,48.109 L 30.829,43.703 C 31.562,43.336 32.438,43.336 33.172,43.703 L 41.983,48.109 C 42.637,48.436 43.342,48.599 44.048,48.599 44.717,48.599 45.388,48.452 46.015,48.157 L 53,44.87 53,48 C 53,51.045 51.043,53.634 48.323,54.595 Z M 46.227,54.989 C 46.151,54.991 46.077,55 46,55 L 43.766,55 45,52.944 46.227,54.989 Z M 20.234,55 L 18,55 C 17.923,55 17.849,54.991 17.773,54.989 L 19,52.944 20.234,55 Z M 58.496,40.073 L 45.163,46.347 C 44.432,46.691 43.598,46.68 42.876,46.32 L 34.065,41.914 C 33.419,41.591 32.709,41.43 32,41.43 31.291,41.43 30.581,41.592 29.934,41.915 L 21.123,46.321 C 20.4,46.682 19.566,46.692 18.836,46.348 L 5.504,40.073 C 4.59,39.643 4,38.713 4,37.703 4,36.802 4.455,35.974 5.216,35.492 5.976,35.008 6.919,34.948 7.735,35.333 L 17.986,40.157 C 19.275,40.763 20.744,40.745 22.019,40.109 L 30.83,35.703 C 31.563,35.336 32.439,35.336 33.173,35.703 L 41.984,40.109 C 43.258,40.745 44.728,40.763 46.017,40.157 L 56.268,35.333 C 57.084,34.949 58.025,35.009 58.787,35.492 59.545,35.975 60,36.802 60,37.703 60,38.713 59.41,39.643 58.496,40.073 Z M 59,33.385 C 57.845,32.95 56.56,32.985 55.414,33.524 L 45.163,38.348 C 44.433,38.692 43.598,38.682 42.876,38.321 L 34.065,33.915 C 32.771,33.269 31.227,33.269 29.933,33.915 L 21.122,38.321 C 20.399,38.682 19.565,38.692 18.835,38.348 L 8.586,33.523 C 7.439,32.985 6.155,32.949 5,33.385 L 5,25.432 C 5.413,26.123 5.898,26.778 6.485,27.364 9.346,30.225 13.716,30.855 17.013,30.855 19.484,30.855 21.352,30.501 21.527,30.467 21.808,30.412 22.041,30.236 22.184,30 L 27,30 C 27.552,30 28,29.552 28,29 28,19.287 23.224,10.757 16.077,6 L 26.284,6 C 26.62,6.553 27.232,6.986 28,7.305 L 28,11 C 28,11.552 28.448,12 29,12 L 35,12 C 35.552,12 36,11.552 36,11 L 36,7.305 C 36.768,6.986 37.38,6.553 37.716,6 L 47.923,6 C 40.776,10.757 36,19.287 36,29 36,29.552 36.448,30 37,30 L 41.816,30 C 41.959,30.236 42.192,30.411 42.473,30.467 42.648,30.501 44.515,30.855 46.987,30.855 50.283,30.855 54.655,30.225 57.515,27.364 58.102,26.777 58.587,26.123 59,25.432 L 59,33.385 Z" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ChainType}" Value="Body">
                    <Setter Property="Fill" TargetName="Icon" Value='DarkGreen' />
                    <Setter Property="Data" TargetName="Icon"
                            Value="M 0,64 C 0,28.6538 28.6538,0 64,0 L 64,0 C 99.3462,0 128,28.6538 128,64 L 128,64 C 128,99.3462 99.3462,128 64,128 L 64,128 C 28.6538,128 0,99.3462 0,64 M 20.625,64 C 20.625,40.0446 40.0446,20.625 64,20.625 L 64,20.625 C 87.9554,20.625 107.375,40.0446 107.375,64 L 107.375,64 C 107.375,87.9554 87.9554,107.375 64,107.375 L 64,107.375 C 40.0446,107.375 20.625,87.9554 20.625,64 M 28.046,64.397 C 28.046,44.4341 44.2291,28.251 64.192,28.251 L 64.192,28.251 C 84.1549,28.251 100.338,44.4341 100.338,64.397 L 100.338,64.397 C 100.338,84.3599 84.1549,100.543 64.192,100.543 L 64.192,100.543 C 44.2291,100.543 28.046,84.3599 28.046,64.397 M 35.083,64.397 C 35.083,48.4271 48.0291,35.481 63.999,35.481 L 63.999,35.481 C 79.9689,35.481 92.915,48.4271 92.915,64.397 L 92.915,64.397 C 92.915,80.3669 79.9689,93.313 63.999,93.313 L 63.999,93.313 C 48.0291,93.313 35.083,80.3669 35.083,64.397 M 42.313,64.397 C 42.313,52.4196 52.0226,42.71 64,42.71 L 64,42.71 C 75.9774,42.71 85.687,52.4196 85.687,64.397 L 85.687,64.397 C 85.687,76.3744 75.9774,86.084 64,86.084 L 64,86.084 C 52.0226,86.084 42.313,76.3744 42.313,64.397  M 64.001,42.652 L 70.381,55.583 84.651,57.655 74.326,67.721 76.764,81.934 64.001,75.223 51.237,81.934 53.675,67.721 43.349,57.655 57.619,55.583  Z" />
                </DataTrigger> 
                <DataTrigger Binding="{Binding ChainType}" Value="Wall">
                    <Setter Property="Fill" TargetName="Icon" Value='Black' />
                    <Setter Property="Data" TargetName="Icon"
                            Value="M 0,63.75 C 0,28.4038 28.6538,-0.25 64,-0.25 L 64,-0.25 C 99.3462,-0.25 128,28.4038 128,63.75 L 128,63.75 C 128,99.0962 99.3462,127.75 64,127.75 L 64,127.75 C 28.6538,127.75 0,99.0962 0,63.75 M 37.1,30.006 L 90.901,30.006 90.901,41.093 37.1,41.093 M 37.1,86.408 L 90.901,86.408 90.901,97.494 37.1,97.494 M 63.837,48.18 C 72.515,48.18 79.574,55.24 79.574,63.918 79.574,72.595 72.514,79.654 63.837,79.654 55.16,79.654 48.1,72.595 48.1,63.918 48.1,55.24 55.159,48.18 63.837,48.18 M 63.837,37.18 C 49.07,37.18 37.1,49.15 37.1,63.918 37.1,78.684 49.071,90.654 63.837,90.654 78.603,90.654 90.574,78.683 90.574,63.918 90.574,49.15 78.604,37.18 63.837,37.18  Z" />
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>
    </Window.Resources>

    <Window.InputBindings>
        <KeyBinding Command="{Binding DownCommand}" Key="Down" />
        <KeyBinding Command="{Binding UpCommand}" Key="Up" />
        <KeyBinding Command="{Binding LeftCommand}" Key="Left" />
        <KeyBinding Command="{Binding RightCommand}" Key="Right" />
        <KeyBinding Command="{Binding ShotCommand}" Key="P" />
    </Window.InputBindings>
    <Grid>

        <Grid.Resources>
            <Style TargetType="ItemsControl">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=Window, Path=DataContext.SwitchView}" Value="1">
                        <Setter Property="Visibility" Value="Visible" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Grid.Resources>


        <ItemsControl ItemsSource="{Binding Blocks}"
                      ItemTemplate="{StaticResource ListTemplate}"
                      ItemsPanel="{StaticResource ListPanelTemplate}"
                      x:Name="ItemsControl">


            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Canvas.Left" Value="{Binding Left}" />
                    <Setter Property="Canvas.Top" Value="{Binding Top}" />

                </Style>
            </ItemsControl.ItemContainerStyle>
            <ItemsControl.Background>
                <ImageBrush ImageSource="{Binding BackImage}" />
            </ItemsControl.Background>

        </ItemsControl>

        <ItemsControl ItemsSource="{Binding Walls}"
                      ItemTemplate="{StaticResource ListTemplate}"
                      ItemsPanel="{StaticResource ListPanelTemplate}">

            <ItemsControl.ItemContainerStyle>
                <Style TargetType="ContentPresenter">
                    <Setter Property="Canvas.Left" Value="{Binding Left}" />
                    <Setter Property="Canvas.Top" Value="{Binding Top}" />
                </Style>
            </ItemsControl.ItemContainerStyle>
        </ItemsControl>
    </Grid>

</Window>